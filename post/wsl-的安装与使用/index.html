<!DOCTYPE html>
<html>

<head>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-104502658-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-104502658-1');
  </script>
  

  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>WSL 的安装与使用  &middot; Mogeko`s Blog</title>
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link rel="canonical" href="https://mogeko.github.io/post/wsl-%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/">
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/dracula.min.css">
  <link rel="stylesheet" href="/css/styles.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  
  <link rel="stylesheet" href="/css/custom.css">
  <script src="/js/jquery.js"></script>
  <script src="/js/custom.js"></script>

</head>

<body>
  <div class="top-scroll-bar"></div>
  <div class="navbar">
    <ul>
      <li><a href="/" class="logo-title">HELLO,WORLD!</a></li>
      <li><a href="/categories">CATEGORIES</a></li>
      <li><a href="/tags">TAGS</a></li>
    </ul>
  </div>
  <div class="container">
    <div class="title">
      <a href="/">
        <img src="/images/logo.png" width="260px" height="48px" />
      </a>
    </div>


<a href="https://mogeko.github.io/post/wsl-%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/">
  <div class="post-title">
    <img src="/images/post-title-icon.png" />
    <div class="post-meta">
      <time>04 Jun 2018, 18:00</time>
      <h1>WSL 的安装与使用</h1>
    </div>
  </div>
</a>



<section class="post-content">
  <p><img src="https://mogeko.github.io/post/wsl-%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/logo.png" alt="Logo" /></p>

<p>16 年 12 月份的时候，微软发布了 Windows Subsystem for Linux (WSL)，通过子系统的方式运行了一个完整的 Linux 系统。使得在 Windows 中使用 Linux 中的工具链成为可能。(Windows 果然是最好的 Linux 发行版)</p>

<p>从微软宣布 WSL 的第一天起，我就一直在关注这项技术。因为我虽然通过双系统的方式安装了 Ubuntu，但切换系统需要从启的机制确实不方便，让我离开 Windows 又实在是不太现实。 (学习的原因，离不开 Visual Studio 和 Adobe 全家桶) WSL 似乎是平衡性能和易用性的最好解决方案了。怎奈何 WSL 只支持 64 位的系统，让我这台老电脑很是尴尬。</p>

<p>如今换电脑了！终于可以享受 WSL 的便利了！！ (*^▽^*)</p>

<p>第一次使用时，<strong>如果发现没有 WSL 中没有网络连接，可以试着重启一下 WSL，还是没网重启一下 Windows</strong></p>

<h1 id="安装">安装</h1>

<p>用<strong>管理员权限</strong>打开 PowerShell 并运行下面的命令</p>

<pre><code>Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux
</code></pre>

<p><strong>或者：</strong>控制面板 -&gt; 程序和功能-&gt; 启用或关闭 Windows 功能 -&gt; 勾选 <code>适用于 Linux 的 Windows 子系统</code>
<img src="https://mogeko.github.io/post/wsl-%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/install_1.png" alt="安装 WSL" /></p>

<p>重启电脑</p>

<p>打开应用商城，搜索：<code>WSL</code>，可根据需求选择安装一个或多个 Linux 系统
<img src="https://mogeko.github.io/post/wsl-%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/install_2.png" alt="安装 WSL" /></p>

<p>安装完成后再开始菜单中启动。
第一次启动会需要初始化，需要配置一段时间。
<img src="https://mogeko.github.io/post/wsl-%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/init_1.png" alt="初始化" />
配置结束后会让你输入用户名和 root 密码 (输入 root 密码时没有显示是正常的；root 密码请务必牢记)
<img src="https://mogeko.github.io/post/wsl-%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/init_2.png" alt="初始化" />
然后就可以使用了！</p>

<h1 id="使用-wsl">使用 WSL</h1>

<h2 id="启动">启动</h2>

<p>你可以通过以下方式<strong>启动 WSL</strong></p>

<ul>
<li>通过<code>开始菜单</code>启动</li>
<li>打开 cmd 或者 <code>Win + R</code> 输入： <code>wsl</code> 或者 <code>bash</code></li>
<li>打开 cmd 或者 <code>Win + R</code> 输入： <code>wsl [command]</code> 或者 <code>bash -c [command]</code></li>
<li>打开 cmd 或者 <code>Win + R</code> 输入： [Linux系统名称]（如：ubuntu），这跟上面在开始菜单里启动是一样的</li>
</ul>

<p>其中，前两种方式会运行默认的 Linux 系统，当你安装多个 Linux 系统之后可以使用 <code>wslconfig</code> 来指定默认的 Linux 系统。</p>

<h2 id="换源">换源</h2>

<h3 id="更换-apt-源">更换 apt 源</h3>

<p>因为 Ubuntu 的官方源架在国外的服务器上的，国内使用官方源下软件就会很慢。我们可以通过将软件源换成国内的镜像源来解决这个问题。
首先备份</p>

<pre><code>cp /etc/apt/sources.list /etc/apt/sources.list.bak
</code></pre>

<p>然后换源，这里我推荐使用清华大学的镜像源
首先使用 vim 打开文件 <code>sources.list</code> (需要 root 权限) -&gt; <a href="http://www.runoob.com/linux/linux-vim.html">vim 教程</a></p>

<pre><code>vim /etc/apt/sources.list
</code></pre>

<p>删除掉所有内容，然后将以下文本粘贴上去</p>

<pre><code># 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse

# 预发布软件源，不建议启用
# deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse
</code></pre>

<p>执行 <code>:wq</code> 保存并退出 vim，然后执行以下命令更新一下软件包列表。</p>

<pre><code>sudo apt update
</code></pre>

<p>一般情况下，会有软件需要更新，使用以下命令更新软件包 (可选)</p>

<pre><code>sudo apt upgrage
</code></pre>

<h3 id="更换-pip-源">更换 pip 源</h3>

<p>创建pip配置文件</p>

<pre><code>mkdir ~/.pip &amp;&amp; touch ~/.pip/pip.conf
</code></pre>

<p>首先使用 vim 打开文件 <code>pip.conf</code></p>

<pre><code>vim ~/.pip/pip.conf
</code></pre>

<p>以下文本粘贴上去，并保存</p>

<pre><code>[global]
index-url = https://pypi.tuna.tsinghua.edu.cn/simple
</code></pre>

<h2 id="安装-zsh">安装 zsh</h2>

<p>zsh 是 Linux 下最强大的shell。虽然大多数 Linux 发行版都默认使用<code>bash shell</code>, 但是丝毫不影响极客们对zsh的热衷。很多 Linux 发行版都包含有 zsh，就算没有，也可以很简单的通过 <code>apt</code> 、urpmi<code>或</code>yum` 等包管理器进行安装。</p>

<p>Zsh具有以下主要功能：</p>

<ul>
<li>开箱即用、可编程的命令行补全功能可以帮助用户输入各种参数以及选项</li>
<li>在用户启动的所有 shell 中共享命令历史</li>
<li>通过扩展的文件通配符，可以不利用外部命令达到 <code>find</code> 命令一般展开文件名</li>
<li>改进的变量与数组处理</li>
<li>在缓冲区中编辑多行命令</li>
<li>多种兼容模式，例如使用 <code>/bin/sh</code> 运行时可以伪装成 Bourne shell</li>
<li>可以定制呈现形式的提示符；包括在屏幕右端显示信息，并在键入长命令时自动隐藏</li>
<li>可加载的模块，提供其他各种支持：完整的 TCP 与 Unix 域套接字控制，FTP 客户端与扩充过的数学函数</li>
<li>完全可定制化</li>
</ul>

<p><a href="https://www.zhihu.com/question/21418449">为什么说 zsh 是 shell 中的极品？</a></p>

<p>在 Ubuntu 中，我们使用 <code>apt</code> 来安装 zsh (需要 root 权限)</p>

<pre><code>sudo apt install  
</code></pre>

<h3 id="安装-oh-my-zsh">安装 oh-my-zsh</h3>

<p><code>oh-my-zsh</code> 是 zsh 中最流行的配色方案，十分养眼。</p>

<p>安装也十分简单，可以直接使用如下命令进行安装</p>

<pre><code>sh -c &quot;$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)&quot;
</code></pre>

<h3 id="将-zsh-设置成-linux-系统的默认-shell">将 zsh 设置成 Linux 系统的默认 Shell</h3>

<p>依然先备份</p>

<pre><code>cp ~/.bashrc ~/.bashrc.bak
</code></pre>

<p>然后使用 vim 打开文件 <code>.bashrc</code></p>

<pre><code>vim ~/.bashrc
</code></pre>

<p>删除掉所有内容，然后将以下文本粘贴上去，并保存</p>

<pre><code>if [ -t 1 ]; then
exec zsh
fi
</code></pre>

<p>更新.bashrc</p>

<pre><code>source ~/.bashrc
</code></pre>

<p>重启 WSL，就可以看到漂亮的 zsh 了！！</p>

<h1 id="配置">配置</h1>

<h2 id="wslconfig-相关设置">wslconfig 相关设置</h2>

<p>在 <code>bash</code>、<code>cmd</code>、<code>PowerShell</code> 中使用以下命令对 WSL 进行配置。
设置默认的 Linux 系统</p>

<pre><code>wslconfig /setdefault [DistributionName]
</code></pre>

<p>卸载 Linux 系统</p>

<pre><code>wslconfig /unregister [DistributionName]
</code></pre>

<p>查看已安装的linux系统</p>

<pre><code>wslconfig /list
</code></pre>

<h2 id="ubuntu-相关设置">Ubuntu 相关设置</h2>

<p>设置默认登陆用户 (默认为第一次运行时输入的用户名)</p>

<pre><code>ubuntu config --default-user root
</code></pre>

<h2 id="vim-相关配置">vim 相关配置</h2>

<p>vim 使用配置文件 <code>~/.vimrc</code> 进行配置。这里是我个人使用的 <a href="https://gist.github.com/291effaf70cce916ce8b1c2a964fcc0d">vim 配置</a>，欢迎 <code>clone</code>
我也写了个配置脚本，执行以下命令可以自动完成大部分配置</p>

<pre><code>wget https://gist.githubusercontent.com/Mogeko/291effaf70cce916ce8b1c2a964fcc0d/raw/2dd5167e0af890c3a3f636a960befe53e7ab8f57/Install.sh &amp;&amp; chmod +x Install.sh &amp;&amp;./Install.sh &amp;&amp; rm Install.sh
</code></pre>

<p>执行完后输入 <code>vim</code> 打开 vim，然后输入命令 <code>:PlugInstall</code> 安装插件。</p>
</section>

<div class="share">
  <a href="http://www.facebook.com/sharer.php?src=bm&u=https%3a%2f%2fmogeko.github.io%2fpost%2fwsl-%25E7%259A%2584%25E5%25AE%2589%25E8%25A3%2585%25E4%25B8%258E%25E4%25BD%25BF%25E7%2594%25A8%2f&t=WSL%20%e7%9a%84%e5%ae%89%e8%a3%85%e4%b8%8e%e4%bd%bf%e7%94%a8" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-facebook"></i></a>
  <a href="http://twitter.com/intent/tweet?url=https%3a%2f%2fmogeko.github.io%2fpost%2fwsl-%25E7%259A%2584%25E5%25AE%2589%25E8%25A3%2585%25E4%25B8%258E%25E4%25BD%25BF%25E7%2594%25A8%2f&text=WSL%20%e7%9a%84%e5%ae%89%e8%a3%85%e4%b8%8e%e4%bd%bf%e7%94%a8&tw_p=tweetbutton" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-twitter"></i></a>
  <a href="https://plus.google.com/share?url=https%3a%2f%2fmogeko.github.io%2fpost%2fwsl-%25E7%259A%2584%25E5%25AE%2589%25E8%25A3%2585%25E4%25B8%258E%25E4%25BD%25BF%25E7%2594%25A8%2f" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-google-plus"></i></a>
  <a href="http://getpocket.com/edit?url=https%3a%2f%2fmogeko.github.io%2fpost%2fwsl-%25E7%259A%2584%25E5%25AE%2589%25E8%25A3%2585%25E4%25B8%258E%25E4%25BD%25BF%25E7%2594%25A8%2f&title=WSL%20%e7%9a%84%e5%ae%89%e8%a3%85%e4%b8%8e%e4%bd%bf%e7%94%a8" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-get-pocket"></i></a>
</div>

<div class="post-meta-code">
  <div class="desc">
    public string description() {
    <div class="desc">val author = "
    
        <a href="mailto:zhengjunyi@live.com"></a>
    ";
    </div>
    
    }
  </div>
  <div class="desc">
    public string tags() {
      <div class="desc">
        val tags = [
        
          
          <a href="https://mogeko.github.iotags/ubuntu">"Ubuntu"</a>
          
          <a href="https://mogeko.github.iotags/windows">"Windows"</a>
          
        
        ];
      </div>
    }
  </div>
</div>


<div class="post-comment">
    
      

<div id="gitalk-container"></div>
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
  <script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js"></script>
  <script type="text/javascript">
    const gitalk = new Gitalk({
      clientID: '936cecdd2ab935870ca5',
      clientSecret: '39cfc7a3cb9a974b6609f3fdaa637e2917e3e40a',
      repo: 'mogeko.github.io',
      owner: 'Mogeko',
      admin: 'Mogeko'.split(','),
      pagerDirection: 'last',
      id: md5(window.location.pathname),
      
      distractionFreeMode: false
    })
    gitalk.render('gitalk-container')
  </script>
</div>

<div class="paging post-paging">
  
  <a class="left" href="https://mogeko.github.io/post/%E6%9C%AC%E5%9C%B0%E6%90%AD%E5%BB%BA-kms-%E6%BF%80%E6%B4%BB%E6%9C%8D%E5%8A%A1/" rel="prev">
    <i class="fa fa-caret-left" aria-hidden="true"></i> <span>本地搭建 KMS 激活服务</span>
  </a>
  
  
  <a class="right" href="https://mogeko.github.io/post/%E4%BD%BF%E7%94%A8-android-%E6%89%8B%E6%9C%BA%E6%90%AD%E5%BB%BA-kms-%E6%BF%80%E6%B4%BB%E6%9C%8D%E5%8A%A1%E5%99%A8/" rel="next">
    <span>使用 Android 手机搭建 KMS 激活服务器</span> <i class="fa fa-caret-right" aria-hidden="true"></i>
  </a>
  
</div>

<footer class="footer">
  COPYRIGHT (C) <a href="https://blog.lulab.net">MOGEKO</a>. ALL RIGHTS RESERVED.
</footer>

</body>
</html>

